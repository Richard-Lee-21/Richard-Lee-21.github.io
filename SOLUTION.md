# è§£å†³æ–¹æ¡ˆè¯´æ˜ / Solution Explanation

## é—®é¢˜ / Problem

**ä¸­æ–‡ï¼š**
GitHub Actions ä¸­çš„çˆ¬è™«å¯ä»¥å®šæ—¶è¿è¡Œï¼Œä½†é¡µé¢ä¸ä¼šæ›´æ–°ã€‚

**English:**
The crawler in GitHub Actions runs on schedule, but the pages don't get updated.

## åŸå›  / Root Cause

**ä¸­æ–‡ï¼š**
çˆ¬è™«è™½ç„¶æˆåŠŸæ‰§è¡Œå¹¶ä¿®æ”¹äº†æ–‡ä»¶ï¼Œä½†è¿™äº›æ›´æ”¹åªå­˜åœ¨äºå·¥ä½œæµçš„ä¸´æ—¶ç¯å¢ƒä¸­ï¼Œæ²¡æœ‰è¢«æäº¤ï¼ˆcommitï¼‰å’Œæ¨é€ï¼ˆpushï¼‰å›ä»£ç ä»“åº“ã€‚å› æ­¤ï¼ŒGitHub Pages ä¸çŸ¥é“æœ‰æ–°å†…å®¹éœ€è¦é‡æ–°æ„å»ºã€‚

**English:**
While the crawler successfully executes and modifies files, these changes only exist in the workflow's temporary environment. They are not committed and pushed back to the repository, so GitHub Pages doesn't know there's new content to rebuild.

## è§£å†³æ–¹æ¡ˆ / Solution

### å…³é”®ä¿®æ”¹ / Key Changes

1. **æ·»åŠ å†™å…¥æƒé™ / Add Write Permissions**
   ```yaml
   permissions:
     contents: write
   ```
   å…è®¸å·¥ä½œæµæ¨é€æ›´æ”¹åˆ°ä»“åº“ / Allows the workflow to push changes to the repository

2. **æäº¤å¹¶æ¨é€æ›´æ”¹ / Commit and Push Changes**
   ```bash
   git config --local user.email "github-actions[bot]@users.noreply.github.com"
   git config --local user.name "github-actions[bot]"
   git add -A
   git commit -m "chore: update crawled data [skip ci]"
   git push
   ```
   ç¡®ä¿çˆ¬å–çš„æ•°æ®è¢«ä¿å­˜åˆ°ä»“åº“ / Ensures crawled data is saved to the repository

### å·¥ä½œæµç¨‹ / Workflow

1. â° å®šæ—¶è§¦å‘ï¼ˆæ¯å¤©åˆå¤œ UTCï¼‰/ Scheduled trigger (daily at midnight UTC)
2. ğŸ¤– è¿è¡Œçˆ¬è™«è·å–æ•°æ® / Run crawler to fetch data
3. ğŸ’¾ æäº¤æ›´æ”¹åˆ°ä»“åº“ / Commit changes to repository
4. ğŸ“¤ æ¨é€åˆ° GitHub / Push to GitHub
5. ğŸ”„ GitHub Pages è‡ªåŠ¨é‡å»º / GitHub Pages automatically rebuilds
6. âœ… é¡µé¢æ˜¾ç¤ºæœ€æ–°æ•°æ® / Page displays latest data

## ä½¿ç”¨æ–¹æ³• / Usage

### æµ‹è¯• / Testing

1. è¿›å…¥ Actions æ ‡ç­¾é¡µ / Go to Actions tab
2. é€‰æ‹© "Scheduled Crawler" å·¥ä½œæµ / Select "Scheduled Crawler" workflow
3. ç‚¹å‡» "Run workflow" / Click "Run workflow"
4. ç­‰å¾…å®Œæˆåæ£€æŸ¥ä»“åº“ä¸­çš„æ–°æ–‡ä»¶ / After completion, check for new files in repository
5. GitHub Pages å°†è‡ªåŠ¨é‡å»º / GitHub Pages will automatically rebuild

### è‡ªå®šä¹‰ / Customization

ç¼–è¾‘ `.github/workflows/crawler.yml` æ–‡ä»¶ï¼Œå°†ç¤ºä¾‹çˆ¬è™«æ›¿æ¢ä¸ºä½ çš„å®é™…çˆ¬è™«é€»è¾‘ã€‚

Edit `.github/workflows/crawler.yml` and replace the example crawler with your actual crawler logic.

## é‡è¦æç¤º / Important Notes

- **`[skip ci]`**: æäº¤ä¿¡æ¯ä¸­çš„è¿™ä¸ªæ ‡è®°é˜²æ­¢æ— é™å¾ªç¯ï¼ˆå¦‚æœä½ æœ‰å…¶ä»– CI/CD åœ¨æ¨é€æ—¶è§¦å‘ï¼‰
  This tag in the commit message prevents infinite loops (if you have other CI/CD that triggers on push)

- **æ›´æ”¹æ£€æµ‹**: å·¥ä½œæµä¼šæ£€æŸ¥æ˜¯å¦æœ‰æ›´æ”¹ï¼Œåªåœ¨æœ‰æ›´æ”¹æ—¶æ‰æäº¤ï¼Œé¿å…ç©ºæäº¤
  Change detection: The workflow checks for changes and only commits when there are changes, avoiding empty commits

- **GitHub Pages è®¾ç½®**: ç¡®ä¿ä½ çš„ GitHub Pages æºè®¾ç½®ä¸ºæ­£ç¡®çš„åˆ†æ”¯ï¼ˆé€šå¸¸æ˜¯ `main`ï¼‰
  GitHub Pages settings: Make sure your GitHub Pages source is set to the correct branch (usually `main`)

## æ–‡ä»¶è¯´æ˜ / Files

- `.github/workflows/crawler.yml` - ä¸»å·¥ä½œæµæ–‡ä»¶ / Main workflow file
- `.github/workflows/README.md` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£ / Detailed technical documentation  
- `index.html` - ç¤ºä¾‹é¡µé¢ï¼Œæ˜¾ç¤ºçˆ¬å–çš„æ•°æ® / Example page displaying crawled data
- `data.json` - çˆ¬è™«ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶ï¼ˆé¦–æ¬¡è¿è¡Œåç”Ÿæˆï¼‰/ Data file generated by crawler (created after first run)

## æ•…éšœæ’é™¤ / Troubleshooting

### é—®é¢˜ï¼šå·¥ä½œæµè¿è¡Œä½†æ²¡æœ‰æ¨é€æ›´æ”¹ / Issue: Workflow runs but doesn't push changes

**è§£å†³æ–¹æ¡ˆ / Solution:**
- æ£€æŸ¥æ˜¯å¦æ·»åŠ äº† `permissions: contents: write`
  Check if `permissions: contents: write` is added
- ç¡®è®¤çˆ¬è™«ç¡®å®ä¿®æ”¹äº†æ–‡ä»¶
  Confirm the crawler actually modifies files

### é—®é¢˜ï¼šGitHub Pages æ²¡æœ‰æ›´æ–° / Issue: GitHub Pages doesn't update

**è§£å†³æ–¹æ¡ˆ / Solution:**
- æ£€æŸ¥ GitHub Pages æ˜¯å¦å¯ç”¨
  Check if GitHub Pages is enabled
- ç¡®è®¤ Pages æºåˆ†æ”¯è®¾ç½®æ­£ç¡®
  Confirm Pages source branch is set correctly
- æŸ¥çœ‹ "pages build and deployment" å·¥ä½œæµæ˜¯å¦æˆåŠŸè¿è¡Œ
  Check if "pages build and deployment" workflow runs successfully
